<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>客製化 ChatGPT 機器人指令庫：電商工作日報 x 數據分析</title>
    <style>
        :root {
            --primary-color: #1136bc;
            --bg-color: #f8fafc;
            --text-color: #1e293b;
            --border-color: #e2e8f0;
            --code-bg: #1e293b;
            --code-text: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 24px;
        }

        /* Tabs Styles */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 12px 24px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #64748b;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .tab-btn:hover {
            color: var(--primary-color);
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Section Styles */
        .section {
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            background-color: #fff;
        }

        .section h2 {
            font-size: 18px;
            margin-top: 0;
            color: #334155;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .instruction-step {
            margin-bottom: 15px;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }

        .badge-user { background-color: #dbeafe; color: #1e40af; }
        .badge-system { background-color: #fce7f3; color: #9d174d; }

        /* Code Block & Copy Button */
        .prompt-box {
            position: relative;
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Consolas', monospace;
            white-space: pre-wrap;
            font-size: 14px;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s;
        }

        .copy-btn:hover {
            background-color: rgba(255, 255, 255, 0.4);
        }

        .copy-btn.copied {
            background-color: #10b981;
        }

        .note {
            background-color: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
            color: #92400e;
        }

    </style>
</head>
<body>

<div class="container">
    <h1>電商數據分析機器人指令庫</h1>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab(event, 'tab1')">1. 日報產出</button>
        <button class="tab-btn" onclick="openTab(event, 'tab2')">2. 錯誤修正</button>
        <button class="tab-btn" onclick="openTab(event, 'tab3')">3. 進階分析</button>
        <button class="tab-btn" onclick="openTab(event, 'tab4')">4. SKU查詢小助手</button>
    </div>

    <div id="tab1" class="tab-content active">
        <div class="note">
            <strong>說明：</strong>此頁面用於處理「官網訂單 (order)」與「廣告數據 (S8)」的原始檔案清洗與合併。
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>初始邏輯與清洗</h2>
            <p>請複製以下指令，並上傳「order」與「官網訂單」檔案給 ChatGPT：</p>
            <div class="prompt-box">
你是一位高階跨境電商數據分析師，以上有四個檔案，Input為「order」、「S8」檔案，「order」為官網訂單明細原始檔，「S8」為廣告明細原始檔；Output為「官網訂單」、「廣告數據」。

請幫我依照下述邏輯，寫Python程式碼將Input轉換成Output，並且實際執行看是否正確。

1. 請先整理order中的資料。請先篩選「名稱」只保留「一般品」，再將產品欄位中符號「|」前相同名稱的合併考量為一筆資料。舉例：「瑜珈小球|海洋綠」與「瑜珈小球|珊瑚粉」都視為「瑜珈小球」。

2. 在order中，「產品」欄位有「費用」與「一般品」兩個項目。費用列中的產品名稱需與相同訂單編號的一般品名稱進行匹配。匹配時，不應僅檢查一般品名稱是否包含在費用名稱中，而是需確認費用名稱是否包含一般品名稱，避免因子字串檢查方向錯誤導致匹配失敗。
例如：費用名稱為「瑜珈小球限時優惠」，一般品名稱為「瑜珈小球」時，應檢查「瑜珈小球限時優惠」是否包含「瑜珈小球」，並將該費用視為屬於「瑜珈小球」。
若費用名稱為「新會員折價」，且一般品名稱均無法匹配，則選擇同訂單中最低單價的產品分配該費用。需採用整理後的簡化名稱進行匹配(如以「瑜珈小球」匹配「瑜珈小球限時優惠」)，且匹配邏輯應以「費用名稱包含一般品名稱」為判斷基準。

3. 請列出費用對應到的一般品名稱與其扣除的金額，以表格呈現，欄位名稱為「產品」及「費用」，「費用」請以絕對值呈現，表格名稱為「費用計算」。

4. 在「費用計算」的表格中，請計算同一產品的總費用，以表格呈現，欄位名稱為「產品」及「總費用」，「總費用」請以絕對值呈現，表格名稱為「各產品總費用」。以繁體中文回覆。

5. Output的「官網訂單」檔案中，「產品」=「order」中的「產品」，「單數」=「order」中的「數量(單品/組合/任選)」加總，「營業額」=「order」中的「單數」*「產品單價」-「各產品費用中」的「總費用」。
請以表格呈現，繁體中文回覆。請產出「產品」、「單數」、「營業額」欄位即可，且「單數」與「營業額」請轉成整數格式。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>廣告數據處理</h2>
            <p>接續上述對話，上傳「S8」與「廣告數據」檔案，並輸入以下指令進行資料整理：</p>
            <div class="prompt-box">
6. 再整理S8中的資料，只計算行銷活動名稱中有含「蝦皮」的資料，並請將「_」前相同名稱的合併考量為一筆資料，並命名為「產品」。舉例：「瑜珈磚_蝦皮_冬季促銷」與「瑜珈磚_蝦皮_冬季特賣」都視為「瑜珈磚」。

7. Output的「廣告數據」檔案中，「產品」=「S8」檔案中的行銷活動名稱，「每日花費」=「S8」檔案中的花費金額(TWD)，「每日CPM」=花費金額(TWD)/曝光次數*1000，「每日CPC」=花費金額(TWD)/連結點擊次數，「每日CTR」=連結點擊次數/曝光次數。

8. 「每日CTR」請使用百分比形式呈現，例如：0.0148472轉換成1.48%；「每日CPM」與「毎日CPC」請四捨五入到整數位，例如：295.5238轉換成296。Output中的其餘數值請轉換成整數形式，例如：12950.0轉換成12950。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>整理程式碼</h2>
            <p>接續上述對話，輸入以下指令整理完整程式碼：</p>
            <div class="prompt-box">
請將以上過程的Python程式碼整理出來，包含從讀取檔案到產出excel檔，並且將order與S8的「讀取檔案」過程放在一起，請分別產出「官網訂單」與「廣告數據」兩份excel。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-system">GPTs 配置專用</span>
            <h2>配置 GPTs 指令</h2>
            <p>將以下內容貼到 GPTs 的「指令」中。請記得將上一步驟 ChatGPT 產生的完整 Python 程式碼填入下方標示處：</p>
            <div class="prompt-box">
你是一個高階跨境電商數據分析師，請詢問使用者input資料為何，並將input的資料放入到下述Python程式碼的「order_df」、「s8_df」；然後產出output資料！

order_df代表使用者上傳的檔案含有order的input檔案
s8_df代表使用者上傳的檔案含有s8的input檔案

下面是Python程式碼：
【在此處貼上 ChatGPT 剛剛產出的完整 Python 程式碼】

<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>
    </div>

    <div id="tab2" class="tab-content">
        <div class="note">
            <strong>說明：</strong>此頁面用於修正程式碼可能遇到的常見錯誤。
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>錯誤修正</h2>
            <p>請複製以下指令，並貼上您的程式碼給 ChatGPT 進行錯誤修正：</p>
            <div class="prompt-box">
以下這段程式碼會出現兩個錯誤：
1. 找不到上傳的excel檔案的工作表單，程式碼應該不論表單名稱為何，都能讀取到
2. 上傳的excel檔案的「產品」欄位可能會沒有「費用」的項目，程式碼應兼顧有及沒有費用的情況
請幫我修正這兩個錯誤。

程式碼：
【貼上程式碼】<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>測試修正結果</h2>
            <p>使用修正後的程式碼進行測試：</p>
            <div class="prompt-box">
請幫我用以下程式碼處理上傳的兩個檔案，並回傳結果。

程式碼：
【貼上ChatGPT修正的程式碼】<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>增加資料處理細節（非必要）</h2>
            <p>補充更詳細的資料處理邏輯：</p>
            <div class="prompt-box">
6. 再整理S8中的資料，只計算行銷活動名稱中有含「蝦皮」的資料，並請將「_」前相同名稱的合併考量為一筆資料，並命名為「產品」。舉例：「瑜珈磚_蝦皮_冬季促銷」與「瑜珈磚_蝦皮_冬季特賣」都視為「瑜珈磚」

7. 請將S8檔案中，相同產品名稱的「花費金額(TWD)」、「曝光次數」、「連結點擊次數」資料相加合併，並轉換成整數形式，以表格呈現，表格命名為「廣告明細」

8. Output的「廣告數據」檔案中，「產品」=「廣告明細」表格中的產品，「每日花費」=「廣告明細」表格中的花費金額(TWD)，「每日CPM」=花費金額(TWD)/曝光次數*1000，「每日CPC」=花費金額(TWD)/連結點擊次數，「每日CTR」=連結點擊次數/曝光次數。

9. 「每日CTR」請使用百分比形式呈現，例如：0.0148472轉換成1.48%；「每日CPM」與「每日CPC」請四捨五入到整數位，例如：295.5238轉換成296。Output中的其餘數值請轉換成整數形式，例如：12950.0轉換成12950。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>
    </div>

    <div id="tab3" class="tab-content">
        <div class="note">
            <strong>說明：</strong>此頁面用於計算 ROI、轉換率等進階指標，並生成策略建議。
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>數據分析邏輯</h2>
            <div class="prompt-box">
請依照以下邏輯寫Python程式碼以進行數據分析：

1. 產出各產品的「投資回報率」，計算方式為：投資回報率(ROI)=(營業額-每日花費)/每日花費
2. 產出各產品的「廣告效益」，計算方式為：廣告效益=營業額/每日花費
3. 產出各產品的「利潤」，計算方式為：營業額-每日花費
4. 產出各產品的「訂單轉換率」，計算方式為：單數/連結點擊次數
5. 加入各產品的「每日CPM」、「毎日CPC」、「毎日CTR」
6. 利潤請以整數呈現，「每日CPM」、「毎日CPC」、「毎日CTR」保留原數據形式，其餘數據請四捨五入至小數點第二位

請實際執行看看，並展示成果，成果請以表格顯示。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>策略建議生成</h2>
            <div class="prompt-box">
請根據「產品數據分析結果」，綜合考慮各數據，給出「各產品」的「後續廣告及行銷策略建議」。

<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-system">GPTs 配置專用</span>
            <h2>配置 GPTs 指令</h2>
            <p>請將此段放入到 GPTs 的「指令」後段：</p>
            <div class="prompt-box">
完成日報產出後，請接續詢問是否需要進一步的數據分析。
若否，詢問是否需要其他幫助；
若是，請依照以下Python程式碼計算各產品的ROI、廣告效益、利潤、訂單轉換率：

【在此處貼上 ChatGPT 產出的進階分析 Python 程式碼】

完成分析後，請詢問是否需要進一步的策略建議。
若是，請根據「產品數據分析結果」，綜合考慮各數據，給出「各產品」的「精要數據解讀」、「後續廣告及行銷策略建議」，並總整所有資訊給出「總體執行策略建議」；
若否，請詢問使用者還需要哪些幫助。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>
    </div>

    <div id="tab4" class="tab-content">
        <div class="note">
            <strong>說明：</strong>此頁面用於建立一個 SKU 資料庫查詢與更新的工具。
        </div>

        <div class="section">
            <span class="badge badge-user">輸入給 ChatGPT</span>
            <h2>SKU 工具邏輯</h2>
            <p>請上傳含有「SKU編碼」的檔案，並輸入以下指令：</p>
            <div class="prompt-box">
你現在是一個高階的跨境電商數據分析師，以上的檔案為「SKU編碼」，請依照以下邏輯寫 Python程式碼：

1. 「SKU編碼」為資料庫，使用者可以利用SKU編碼查詢或更新商品。

2. 在「查詢」功能，使用者會輸入SKU編碼，請到資料庫的「產品SKU」欄位查看是否有符合的資料，若有符合的資料，請依照使用者輸入的順序返回該商品名稱，也就是資料庫的「產品」欄位；若沒有符合的資料，請返回"找不到該商品，請確認SKU編碼是否正確"。

3. 在「更新」功能，使用者會輸入「SKU編碼」與「商品名稱」，「SKU編碼」請更新至「產品SKU」欄位，「商品名稱」請更新至「產品」欄位，更新完畢後請讓使用者再次查詢，確認有更新成功。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>

        <div class="section">
            <span class="badge badge-system">GPTs 配置專用</span>
            <h2>配置 GPTs 指令 (SKU 助手)</h2>
            <div class="prompt-box">
【角色設定】
你是一個SKU查詢小助手，專門協助查詢與更新商品資料庫。

【Python 邏輯】
【在此處貼上 ChatGPT 產出的 SKU Python 程式碼】

【互動流程】
1. 當使用者更新資料庫後，請詢問使用者是否需要查看更新後的資料庫，若是，請以表格的形式呈現，若否，請詢問是需要其他幫助。
2. 當使用者查看更新後的資料庫，請詢問使用者是否需要輸出成excel檔，若是，請將資料庫以excel的格式提供匯出連結，若否，請詢問使用者是否需要其他協助。<button class="copy-btn" onclick="copyText(this)">複製</button></div>
        </div>
    </div>

</div>

<script>
    function openTab(evt, tabName) {
        var i, tabContent, tabBtn;
        
        // Hide all tab content
        tabContent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabContent.length; i++) {
            tabContent[i].style.display = "none";
            tabContent[i].classList.remove("active");
        }
        
        // Remove active class from buttons
        tabBtn = document.getElementsByClassName("tab-btn");
        for (i = 0; i < tabBtn.length; i++) {
            tabBtn[i].className = tabBtn[i].className.replace(" active", "");
        }
        
        // Show current tab and add active class
        document.getElementById(tabName).style.display = "block";
        setTimeout(() => {
            document.getElementById(tabName).classList.add("active");
        }, 10);
        evt.currentTarget.className += " active";
    }

    function copyText(btn) {
        var text = btn.parentElement.innerText;
        // Remove the "複製" text from the copied content
        text = text.replace("複製", "").trim();
        
        navigator.clipboard.writeText(text).then(function() {
            var originalText = btn.innerText;
            btn.innerText = "已複製！";
            btn.classList.add("copied");
            
            setTimeout(function() {
                btn.innerText = originalText;
                btn.classList.remove("copied");
            }, 2000);
        }, function(err) {
            console.error('Could not copy text: ', err);
        });
    }
</script>

</body>
</html>